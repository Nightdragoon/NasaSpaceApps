@{
    ViewData["Title"] = "Welcome | Space BioLab";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Styles {
    <style>
        html, body {
            height: 100%;
            margin: 0;
        }

        body {
            background-color: #0B1226;
            background-image: linear-gradient(180deg, #0B1226, #1E3259);
        }
    </style>


}
  <!-- Fondo principal -->
  <div class="background">
    <div class="overlay"></div>
    <img src="assets/img/pexels-pixabay-41953-removebg-preview.png" class="planet-img" alt="">
  </div>

  <!-- Barra de navegación -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid px-5">
      <a class="navbar-brand d-flex align-items-center" href="index.html">
        <img src="assets/img/logo.png" alt="Logo" width="60" class="me-2">
        SpaceBioLab
      </a>

      <div class="d-flex">
        <!-- IDs + href de respaldo -->
            @if(ViewBag.id == null)
            {
                <a id="btnLoginNav" class="btn  btn-outline-light rounded-pill mx-1" asp-action="login">Login</a>
                <a id="btnRegisterNav" class="btn  btn-outline-light rounded-pill mx-1" asp-action="singUp">Sign Up</a>
            }
        </div>
    </div>
  </nav>



  <!-- Contenido principal -->
<section class="d-flex flex-column justify-content-center align-items-center text-center text-white ">
    <h1 class="display-1 fw-bold mb-3">WELCOME</h1>
    <p class="lead mb-5">“From cells to stars — discover how life adapts beyond Earth.”</p>

    <nav class="navbar bg-transparent ">
        <div class="container-fluid d-flex flex-nowrap align-items-center gap-2 w-100">
            <input class="form-control me-2 col-lg-12 text-white bg-black" type="search" placeholder="Search" id="search" aria-label="Search">
            <button class="btn btn-outline-success" id="searchButton"type="submit">Search</button>
        </div>
    </nav>
    <ul class="list-group bg-transparent" id="busqueda">
    </ul>

    <img src="/fondo.png" alt="" class="hero-bottom-img w-100">


</section>



@section Scripts{
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.js"></script>

    <!-- Controlador -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>



        $('#search').on('input change',async function (){
            let res = await fetch("http://127.0.0.1:8000/enterdata", {
                method: "POST",
                headers: {
                  'Content-Type': 'application/json',
                  'accept' : 'application/json'// Indica que estás enviando JSON
                  },
                 body:JSON.stringify({
                     palabra:$("#search").val()
                 })
            });
            let json = await res.json();
            const et = document.getElementById("busqueda");
            let plantilla = '';
            json.resultados.forEach(function(data){
                plantilla += '<li class="list-group-item bg-transparent text-white"><button class=" btn btn-outline-light w-100 text-white buttonResult py-2" data-title="' +data + '" type="button">' + data + '</button></li>'
            });
            et.innerHTML = plantilla;

        });

        $(".buttonResult").on("click" , async function(){
            console.log("hola")
            let data = $(this).data("title");
            console.log(data);
            $("#search").val(data);
        });
         $('#busqueda').on('click', '.buttonResult', function () {
            const title = $(this).data('title');
            $('#search').val(title); // opcional: dispara nueva búsqueda
        });

       
    </script>
    @if (ViewBag.id != null)
    {
        <script>
                $('#searchButton').on('click' , async function(){
                let res = await fetch('http://127.0.0.1:8000/insertarHistorial' , {
                    method: "POST",
                    headers: {
                      'Content-Type': 'application/json',
                      'accept' : 'application/json'// Indica que estás enviando JSON
                      },
                    body: JSON.stringify({
                        id_usuario: @ViewBag.id,
                        titulo: $('#search').val(),
                        url: "nsql"
                    })
                });

            });
        </script>
    }
}

